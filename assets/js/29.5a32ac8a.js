(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{290:function(a,t,s){"use strict";s.r(t);var e=s(22),n=Object(e.a)({},function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"backend-deployment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#backend-deployment","aria-hidden":"true"}},[a._v("#")]),a._v(" Backend Deployment")]),a._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#update"}},[a._v("Update")])]),s("li",[s("a",{attrs:{href:"#_1-create-remote-server"}},[a._v("1. Create Remote Server")])]),s("li",[s("a",{attrs:{href:"#_2-setup-server"}},[a._v("2. Setup Server")]),s("ul",[s("li",[s("a",{attrs:{href:"#ssh-in-as-root"}},[a._v("SSH in as Root")])])])]),s("li",[s("a",{attrs:{href:"#setup-firewall"}},[a._v("Setup Firewall")]),s("ul",[s("li",[s("a",{attrs:{href:"#enable-external-access-for-user"}},[a._v("Enable External Access for User")])]),s("li",[s("a",{attrs:{href:"#update-ubuntu"}},[a._v("Update Ubuntu")])])])]),s("li",[s("a",{attrs:{href:"#_3-install-net-sdk"}},[a._v("3. Install .NET SDK")])]),s("li",[s("a",{attrs:{href:"#_4-install-tor"}},[a._v("4. Install Tor")])]),s("li",[s("a",{attrs:{href:"#_5-install-configure-and-synchronize-bitcoind"}},[a._v("5. Install, Configure and Synchronize bitcoind")])]),s("li",[s("a",{attrs:{href:"#_6-publish-configure-and-run-walletwasabi-backend"}},[a._v("6. Publish, Configure and Run WalletWasabi.Backend")])]),s("li",[s("a",{attrs:{href:"#_7-monitor-the-apps"}},[a._v("7. Monitor the Apps")]),s("ul",[s("li",[s("a",{attrs:{href:"#walletwasabi-backend"}},[a._v("WalletWasabi.Backend")])]),s("li",[s("a",{attrs:{href:"#tor"}},[a._v("Tor")])])])]),s("li",[s("a",{attrs:{href:"#_8-setup-nginx"}},[a._v("8. Setup nginx")])]),s("li",[s("a",{attrs:{href:"#check-if-everything-works"}},[a._v("Check If Everything Works")])]),s("li",[s("a",{attrs:{href:"#check-statuses"}},[a._v("Check Statuses")])])])]),s("p"),a._v(" "),s("hr"),a._v(" "),s("h2",{attrs:{id:"update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update","aria-hidden":"true"}},[a._v("#")]),a._v(" Update")]),a._v(" "),s("p",[a._v("Consider updating the versions in "),s("code",[a._v("WalletWasabi.Helpers.Constants")]),a._v(".\nIf versions are updated, make sure Client Release is already available before updating the backend.")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" update "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ~/WalletWasabi "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ~\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" nginx stop\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl stop walletwasabi.service\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("killall")]),a._v(" tor\nbitcoin-cli stop\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" upgrade -y "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" autoremove -y\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("reboot")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DOTNET_CLI_TELEMETRY_OPTOUT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\nbitcoind\nbitcoin-cli getblockchaininfo\ntor\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" nginx start\ndotnet publish ~/WalletWasabi/WalletWasabi.Backend --configuration Release --self-contained "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start walletwasabi.service\npgrep -ilfa tor "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" pgrep -ilfa bitcoin "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" pgrep -ilfa wasabi "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" pgrep -ilfa nginx\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" -10000 ~/.walletwasabi/backend/Logs.txt\n")])])]),s("h2",{attrs:{id:"_1-create-remote-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-create-remote-server","aria-hidden":"true"}},[a._v("#")]),a._v(" 1. Create Remote Server")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("Name\nWalletWasabi.Backend.[TestNet/Main]")])]),a._v(" "),s("li",[s("p",[a._v("Image\nUbuntu 18.04 x64")])]),a._v(" "),s("li",[s("p",[a._v("Region\nMostly anywhere is fine, except the US or China.")])]),a._v(" "),s("li",[s("p",[a._v("Size")])])]),a._v(" "),s("p",[s("a",{attrs:{href:"https://bitcoin.org/en/full-node#minimum-requirements",target:"_blank",rel:"noopener noreferrer"}},[a._v("Bitcoin full node minimum requirements"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("[4GB Standard/32GB Standard]")]),a._v(" "),s("h2",{attrs:{id:"_2-setup-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-setup-server","aria-hidden":"true"}},[a._v("#")]),a._v(" 2. Setup Server")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[a._v("Initial server setup with Ubuntu 18.04"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"ssh-in-as-root"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ssh-in-as-root","aria-hidden":"true"}},[a._v("#")]),a._v(" SSH in as Root")]),a._v(" "),s("p",[a._v("Putty (Note copypaste with Ctrl+Insert and Shift+Insert.)\n"),s("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-use-ssh-keys-with-putty-on-digitalocean-droplets-windows-users",target:"_blank",rel:"noopener noreferrer"}},[a._v("How o use ssh keys with putty on Digital Ocean droplets Windowsusers"),s("OutboundLink")],1)]),a._v(" "),s("h4",{attrs:{id:"create-a-new-user-and-grant-administrative-privileges"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-new-user-and-grant-administrative-privileges","aria-hidden":"true"}},[a._v("#")]),a._v(" Create a New User and Grant Administrative Privileges")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("adduser user\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("usermod")]),a._v(" -aG "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" user\n")])])]),s("h2",{attrs:{id:"setup-firewall"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setup-firewall","aria-hidden":"true"}},[a._v("#")]),a._v(" Setup Firewall")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-14-04",target:"_blank",rel:"noopener noreferrer"}},[a._v("How to set up a firewall with UFW on Ubunt 14.04"),s("OutboundLink")],1)]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("ufw allow OpenSSH\nufw "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v("\n")])])]),s("blockquote",[s("p",[a._v("As the firewall is currently blocking all connections except for SSH, if you install and configure additional services, you will need to adjust the firewall settings to allow acceptable traffic in.\nYou can learn some common UFW operations in this guide.  ~ "),s("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands",target:"_blank",rel:"noopener noreferrer"}},[a._v("UFW essentials common firewal rules and commands"),s("OutboundLink")],1)])]),a._v(" "),s("h3",{attrs:{id:"enable-external-access-for-user"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#enable-external-access-for-user","aria-hidden":"true"}},[a._v("#")]),a._v(" Enable External Access for User")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" --archive --chown"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("user:user ~/.ssh /home/user\n")])])]),s("h3",{attrs:{id:"update-ubuntu"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-ubuntu","aria-hidden":"true"}},[a._v("#")]),a._v(" Update Ubuntu")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" update "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" dist-upgrade -y\n")])])]),s("h2",{attrs:{id:"_3-install-net-sdk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-install-net-sdk","aria-hidden":"true"}},[a._v("#")]),a._v(" 3. Install .NET SDK")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.microsoft.com/net/learn/get-started/linux/ubuntu18-04",target:"_blank",rel:"noopener noreferrer"}},[a._v(".Net get started with Ubuntu 18.04"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("Opt out of the telemetry: "),s("code",[a._v("export DOTNET_CLI_TELEMETRY_OPTOUT=1")]),a._v(".")]),a._v(" "),s("h2",{attrs:{id:"_4-install-tor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-install-tor","aria-hidden":"true"}},[a._v("#")]),a._v(" 4. Install Tor")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" tor\n")])])]),s("p",[a._v("Check if Tor is already running in the background:")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("pgrep -ilfa tor\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("killall")]),a._v(" tor\n")])])]),s("p",[a._v("Verify Tor is properly running:")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("tor\n")])])]),s("p",[a._v("Create torrc:")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" pico /etc/tor/torrc\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("HiddenServiceDir /home/user/.hidden_service_v3\nHiddenServiceVersion "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\nHiddenServicePort "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:37127\n\nRunAsDaemon "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ---MAKE TOR FASTER---")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Need to disable for HiddenServiceNonAnonymousMode")]),a._v("\nSOCKSPort "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Need to enable for HiddenServiceSingleHopMode")]),a._v("\nHiddenServiceNonAnonymousMode "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# This option makes every hidden service instance hosted by a tor")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# instance a Single Onion Service. One-hop circuits make Single Onion")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# servers easily locatable, but clients remain location-anonymous.")]),a._v("\nHiddenServiceSingleHopMode "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])])]),s("p",[a._v("Enable firewall:")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v("\n")])])]),s("p",[s("strong",[a._v("Backup the generated private key!")])]),a._v(" "),s("h2",{attrs:{id:"_5-install-configure-and-synchronize-bitcoind"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-install-configure-and-synchronize-bitcoind","aria-hidden":"true"}},[a._v("#")]),a._v(" 5. Install, Configure and Synchronize bitcoind")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://bitcoin.org/en/download",target:"_blank",rel:"noopener noreferrer"}},[a._v("Download bitcoind"),s("OutboundLink")],1)]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" add-apt-repository ppa:bitcoin/bitcoin\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" update\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" bitcoind\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" ~/.bitcoin\npico ~/.bitcoin/bitcoin.conf\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("testnet")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("/1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main/test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".rpcworkqueue"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("64")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main/test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".txindex"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main/test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".daemon"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main/test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".server"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main/test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".rpcuser"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("bitcoinuser\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main/test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".rpcpassword"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("password\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main/test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".whitebind"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8333")]),a._v("/18333"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),s("p",[s("a",{attrs:{href:"https://bitcoincore.org/en/releases/0.17.0/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Bitcoin Core v0.17.0"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://medium.com/@loopring/how-to-run-lighting-btc-node-and-start-mining-b55c4bab8ad",target:"_blank",rel:"noopener noreferrer"}},[a._v("How to run Lightninb BTC node and start mining"),s("OutboundLink")],1),a._v(" "),s("a",{attrs:{href:"https://github.com/MrChrisJ/fullnode/issues/18",target:"_blank",rel:"noopener noreferrer"}},[a._v("Adding a Firewall"),s("OutboundLink")],1)]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18333")]),a._v("/8333"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nbitcoind\nbitcoin-cli getblockcount\nbitcoin-cli stop\nbitcoind\n")])])]),s("h2",{attrs:{id:"_6-publish-configure-and-run-walletwasabi-backend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-publish-configure-and-run-walletwasabi-backend","aria-hidden":"true"}},[a._v("#")]),a._v(" 6. Publish, Configure and Run WalletWasabi.Backend")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://github.com/zkSNACKs/WalletWasabi.git\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" WalletWasabi\ndotnet restore\ndotnet build\ndotnet publish WalletWasabi.Backend --configuration Release --self-contained "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\ndotnet WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish/WalletWasabi.Backend.dll\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" .walletwasabi/backend/Logs.txt\npico .walletwasabi/backend/Config.json\npico .walletwasabi/backend/CcjRoundConfig.json\ndotnet WalletWasabi/WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish/WalletWasabi.Backend.dll\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" .walletwasabi/backend/Logs.txt\n")])])]),s("h2",{attrs:{id:"_7-monitor-the-apps"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-monitor-the-apps","aria-hidden":"true"}},[a._v("#")]),a._v(" 7. Monitor the Apps")]),a._v(" "),s("h3",{attrs:{id:"walletwasabi-backend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#walletwasabi-backend","aria-hidden":"true"}},[a._v("#")]),a._v(" WalletWasabi.Backend")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/linux-nginx?view=aspnetcore-2.0&tabs=aspnetcore2x",target:"_blank",rel:"noopener noreferrer"}},[a._v("Aspnet host and deploy Linux nginx"),s("OutboundLink")],1)]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" pico /etc/systemd/system/walletwasabi.service\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Unit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Description")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("WalletWasabi Backend API\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("WorkingDirectory")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/user/WalletWasabi/WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ExecStart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/bin/dotnet /home/user/WalletWasabi/WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish/WalletWasabi.Backend.dll\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Restart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("always\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RestartSec")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Restart service after 10 seconds if dotnet service crashes")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("SyslogIdentifier")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("walletwasabi-backend\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("User")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("user\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Environment")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("DOTNET_PRINT_TELEMETRY_MESSAGE"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("false\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Install"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("WantedBy")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("multi-user.target\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" walletwasabi.service\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start walletwasabi.service\nsystemctl status walletwasabi.service\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" -10000 .walletwasabi/backend/Logs.txt\n")])])]),s("h3",{attrs:{id:"tor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tor","aria-hidden":"true"}},[a._v("#")]),a._v(" Tor")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("tor\npgrep -ilfa tor\n")])])]),s("h2",{attrs:{id:"_8-setup-nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-setup-nginx","aria-hidden":"true"}},[a._v("#")]),a._v(" 8. Setup nginx")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/linux-nginx?view=aspnetcore-2.0&tabs=aspnetcore2x#install-nginx",target:"_blank",rel:"noopener noreferrer"}},[a._v("Aspnet install nginx"),s("OutboundLink")],1),a._v("\nOnly setup nginx if you want to expose the autogenerated website to the clearnet.")]),a._v(" "),s("p",[a._v("Enable firewall:")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ufw allow http\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ufw allow https\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" nginx -y\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" nginx start\n")])])]),s("p",[a._v("Verify the browser displays the default landing page for Nginx.\nThe landing page is reachable at "),s("code",[a._v("http://<server_IP_address>/index.nginx-debian.html")]),a._v(".")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" pico /etc/nginx/sites-available/default\n")])])]),s("p",[a._v("Fill out the server name with the server's IP and domain.\nAnd remove the unneeded domains (note I use "),s("code",[a._v("wasabiwallet.co")]),a._v(" for testnet.)")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("server {\n    listen        80;\n    listen        [::]:80;\n    listen        443 ssl;\n    listen        [::]:443 ssl;\n    server_name   [InsertServerIPHere] wasabiwallet.io www.wasabiwallet.io wasabiwallet.net www.wasabiwallet.net wasabiwallet.org www.wasabiwallet.org wasabiwallet.info www.wasabiwallet.info wasabiwallet.co www.wasabiwallet.co zerolink.info www.zerolink.info hiddenwallet.org www.hiddenwallet.org;\n    location / {\n        proxy_pass         http://localhost:37127;\n    }\n}\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" nginx -t\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" nginx -s reload\n")])])]),s("p",[a._v("Setup https, redirect to https when asks.\nThis will modify the above config file, but oh well.")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" certbot -d wasabiwallet.io -d www.wasabiwallet.io -d wasabiwallet.net -d www.wasabiwallet.net -d wasabiwallet.org -d www.wasabiwallet.org -d wasabiwallet.info -d www.wasabiwallet.info -d wasabiwallet.co -d www.wasabiwallet.co -d zerolink.info -d www.zerolink.info -d hiddenwallet.org -d www.hiddenwallet.org\n")])])]),s("p",[a._v("certbot will not properly redirect www, so it must be setup by hand, one by one.\nDuplicate all entries like this by adding a "),s("code",[a._v("www.")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("server {\n    if ($host = wasabiwallet.co) {\n        return 301 https://$host$request_uri;\n    }\n}\n")])])]),s("p",[a._v("Add "),s("code",[a._v('add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;')]),a._v(" and "),s("code",[a._v("server_tokens off;")]),a._v(" to every HTTPS "),s("code",[a._v("server")]),a._v(" block.")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" nginx -t\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" nginx -s reload\n")])])]),s("p",[a._v("After accessing the website finalize preload in https://hstspreload.org/")]),a._v(" "),s("h2",{attrs:{id:"check-if-everything-works"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#check-if-everything-works","aria-hidden":"true"}},[a._v("#")]),a._v(" Check If Everything Works")]),a._v(" "),s("p",[a._v("TestNet: http://testwnp3fugjln6vh5vpj7mvq3lkqqwjj3c2aafyu7laxz42kgwh2rad.onion/swagger/\nMain: http://wasabiukrxmkdgve5kynjztuovbg43uxcbcxn6y2okcrsg7gb6jdmbad.onion/swagger/\nGET fees")]),a._v(" "),s("p",[a._v("http://www.wasabiwallet.io/")]),a._v(" "),s("h2",{attrs:{id:"check-statuses"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#check-statuses","aria-hidden":"true"}},[a._v("#")]),a._v(" Check Statuses")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" -f ~/.bitcoin/debug.log\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" -10000 .walletwasabi/backend/Logs.txt\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("du")]),a._v(" -bsh .walletwasabi/backend/IndexBuilderService/*\n")])])])])},[],!1,null,null,null);t.default=n.exports}}]);