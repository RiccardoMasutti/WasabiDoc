<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Backend Deployment | Wasabi</title>
    <meta name="description" content="Wasabi is an open-source, non-custodial, privacy focused Bitcoin wallet for desktop.">
    <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700|Playfair+Display:700&amp;display=swap">
    
    <link rel="preload" href="/assets/css/0.styles.90f8e893.css" as="style"><link rel="preload" href="/assets/js/app.9b39d3c4.js" as="script"><link rel="preload" href="/assets/js/2.5eea116b.js" as="script"><link rel="preload" href="/assets/js/29.5a32ac8a.js" as="script"><link rel="prefetch" href="/assets/js/10.3a5f09e3.js"><link rel="prefetch" href="/assets/js/11.7f3772fb.js"><link rel="prefetch" href="/assets/js/12.860ace3c.js"><link rel="prefetch" href="/assets/js/13.c5648798.js"><link rel="prefetch" href="/assets/js/14.f1c77820.js"><link rel="prefetch" href="/assets/js/15.9d729972.js"><link rel="prefetch" href="/assets/js/16.e76264ef.js"><link rel="prefetch" href="/assets/js/17.e03eae14.js"><link rel="prefetch" href="/assets/js/18.79e784f2.js"><link rel="prefetch" href="/assets/js/19.2efac768.js"><link rel="prefetch" href="/assets/js/20.d1292598.js"><link rel="prefetch" href="/assets/js/21.536c3b03.js"><link rel="prefetch" href="/assets/js/22.c6f4abb0.js"><link rel="prefetch" href="/assets/js/23.83c3d52b.js"><link rel="prefetch" href="/assets/js/24.471dd11e.js"><link rel="prefetch" href="/assets/js/25.34d18ddf.js"><link rel="prefetch" href="/assets/js/26.08bc230c.js"><link rel="prefetch" href="/assets/js/27.aac33536.js"><link rel="prefetch" href="/assets/js/28.344ef8cd.js"><link rel="prefetch" href="/assets/js/3.54d52527.js"><link rel="prefetch" href="/assets/js/30.337906fd.js"><link rel="prefetch" href="/assets/js/31.ced0bd9d.js"><link rel="prefetch" href="/assets/js/32.596b0264.js"><link rel="prefetch" href="/assets/js/33.49e23a7b.js"><link rel="prefetch" href="/assets/js/34.417b7d66.js"><link rel="prefetch" href="/assets/js/35.841d8299.js"><link rel="prefetch" href="/assets/js/36.9abbff44.js"><link rel="prefetch" href="/assets/js/37.9201a4b7.js"><link rel="prefetch" href="/assets/js/38.d0373f2e.js"><link rel="prefetch" href="/assets/js/39.969b4ab3.js"><link rel="prefetch" href="/assets/js/4.c6ffc4c1.js"><link rel="prefetch" href="/assets/js/40.999b848c.js"><link rel="prefetch" href="/assets/js/41.4ac92b96.js"><link rel="prefetch" href="/assets/js/42.0362b579.js"><link rel="prefetch" href="/assets/js/5.7fc13274.js"><link rel="prefetch" href="/assets/js/6.387228b3.js"><link rel="prefetch" href="/assets/js/7.cf7b1573.js"><link rel="prefetch" href="/assets/js/8.921b3903.js"><link rel="prefetch" href="/assets/js/9.8d88b1ec.js">
    <link rel="stylesheet" href="/assets/css/0.styles.90f8e893.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/Logo_without_text.png" alt="Wasabi" class="logo"> <span class="site-name can-hide">Wasabi</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/why-wasabi/" class="nav-link">Why Wasabi</a></div><div class="nav-item"><a href="/using-wasabi/InstallPackage.html" class="nav-link">Using Wasabi</a></div><div class="nav-item"><a href="/building-wasabi/TechnicalOverview.html" class="nav-link">Building Wasabi</a></div><div class="nav-item"><a href="/FAQ/" class="nav-link">FAQ</a></div> <a href="https://github.com/zkSNACKs/WasabiDoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/why-wasabi/" class="nav-link">Why Wasabi</a></div><div class="nav-item"><a href="/using-wasabi/InstallPackage.html" class="nav-link">Using Wasabi</a></div><div class="nav-item"><a href="/building-wasabi/TechnicalOverview.html" class="nav-link">Building Wasabi</a></div><div class="nav-item"><a href="/FAQ/" class="nav-link">FAQ</a></div> <a href="https://github.com/zkSNACKs/WasabiDoc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Using Wasabi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/using-wasabi/InstallPackage.html" class="sidebar-link">Install package</a></li><li><a href="/using-wasabi/BuildSource.html" class="sidebar-link">Build from source code</a></li><li><a href="/using-wasabi/DeterministicBuild.html" class="sidebar-link">Deterministic Build</a></li><li><a href="/using-wasabi/ClientDeployment.html" class="sidebar-link">Client Deployment</a></li><li><a href="/using-wasabi/BackendDeployment.html" class="active sidebar-link">Backend Deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#update" class="sidebar-link">Update</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_1-create-remote-server" class="sidebar-link">1. Create Remote Server</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_2-setup-server" class="sidebar-link">2. Setup Server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#ssh-in-as-root" class="sidebar-link">SSH in as Root</a></li></ul></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#setup-firewall" class="sidebar-link">Setup Firewall</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#enable-external-access-for-user" class="sidebar-link">Enable External Access for User</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#update-ubuntu" class="sidebar-link">Update Ubuntu</a></li></ul></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_3-install-net-sdk" class="sidebar-link">3. Install .NET SDK</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_4-install-tor" class="sidebar-link">4. Install Tor</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_5-install-configure-and-synchronize-bitcoind" class="sidebar-link">5. Install, Configure and Synchronize bitcoind</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_6-publish-configure-and-run-walletwasabi-backend" class="sidebar-link">6. Publish, Configure and Run WalletWasabi.Backend</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_7-monitor-the-apps" class="sidebar-link">7. Monitor the Apps</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#walletwasabi-backend" class="sidebar-link">WalletWasabi.Backend</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#tor" class="sidebar-link">Tor</a></li></ul></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#_8-setup-nginx" class="sidebar-link">8. Setup nginx</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#check-if-everything-works" class="sidebar-link">Check If Everything Works</a></li><li class="sidebar-sub-header"><a href="/using-wasabi/BackendDeployment.html#check-statuses" class="sidebar-link">Check Statuses</a></li></ul></li><li><a href="/using-wasabi/AddressReuse.html" class="sidebar-link">Address Reuse</a></li><li><a href="/using-wasabi/BIP.html" class="sidebar-link">Supported BIPs</a></li><li><a href="/using-wasabi/PasswordFinder.html" class="sidebar-link">Password Finder</a></li><li><a href="/using-wasabi/PayToEndPoint.html" class="sidebar-link">Pay To EndPoint</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="backend-deployment"><a href="#backend-deployment" aria-hidden="true" class="header-anchor">#</a> Backend Deployment</h1> <p></p><div class="table-of-contents"><ul><li><a href="#update">Update</a></li><li><a href="#_1-create-remote-server">1. Create Remote Server</a></li><li><a href="#_2-setup-server">2. Setup Server</a><ul><li><a href="#ssh-in-as-root">SSH in as Root</a></li></ul></li><li><a href="#setup-firewall">Setup Firewall</a><ul><li><a href="#enable-external-access-for-user">Enable External Access for User</a></li><li><a href="#update-ubuntu">Update Ubuntu</a></li></ul></li><li><a href="#_3-install-net-sdk">3. Install .NET SDK</a></li><li><a href="#_4-install-tor">4. Install Tor</a></li><li><a href="#_5-install-configure-and-synchronize-bitcoind">5. Install, Configure and Synchronize bitcoind</a></li><li><a href="#_6-publish-configure-and-run-walletwasabi-backend">6. Publish, Configure and Run WalletWasabi.Backend</a></li><li><a href="#_7-monitor-the-apps">7. Monitor the Apps</a><ul><li><a href="#walletwasabi-backend">WalletWasabi.Backend</a></li><li><a href="#tor">Tor</a></li></ul></li><li><a href="#_8-setup-nginx">8. Setup nginx</a></li><li><a href="#check-if-everything-works">Check If Everything Works</a></li><li><a href="#check-statuses">Check Statuses</a></li></ul></div><p></p> <hr> <h2 id="update"><a href="#update" aria-hidden="true" class="header-anchor">#</a> Update</h2> <p>Consider updating the versions in <code>WalletWasabi.Helpers.Constants</code>.
If versions are updated, make sure Client Release is already available before updating the backend.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ~/WalletWasabi <span class="token operator">&amp;&amp;</span> <span class="token function">git</span> pull <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ~
<span class="token function">sudo</span> <span class="token function">service</span> nginx stop
<span class="token function">sudo</span> systemctl stop walletwasabi.service
<span class="token function">sudo</span> <span class="token function">killall</span> tor
bitcoin-cli stop
<span class="token function">sudo</span> <span class="token function">apt-get</span> upgrade -y <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt-get</span> autoremove -y
<span class="token function">sudo</span> <span class="token function">reboot</span>
<span class="token builtin class-name">set</span> <span class="token assign-left variable">DOTNET_CLI_TELEMETRY_OPTOUT</span><span class="token operator">=</span><span class="token number">1</span>
bitcoind
bitcoin-cli getblockchaininfo
tor
<span class="token function">sudo</span> <span class="token function">service</span> nginx start
dotnet publish ~/WalletWasabi/WalletWasabi.Backend --configuration Release --self-contained <span class="token boolean">false</span>
<span class="token function">sudo</span> systemctl start walletwasabi.service
pgrep -ilfa tor <span class="token operator">&amp;&amp;</span> pgrep -ilfa bitcoin <span class="token operator">&amp;&amp;</span> pgrep -ilfa wasabi <span class="token operator">&amp;&amp;</span> pgrep -ilfa nginx
<span class="token function">tail</span> -10000 ~/.walletwasabi/backend/Logs.txt
</code></pre></div><h2 id="_1-create-remote-server"><a href="#_1-create-remote-server" aria-hidden="true" class="header-anchor">#</a> 1. Create Remote Server</h2> <ul><li><p>Name
WalletWasabi.Backend.[TestNet/Main]</p></li> <li><p>Image
Ubuntu 18.04 x64</p></li> <li><p>Region
Mostly anywhere is fine, except the US or China.</p></li> <li><p>Size</p></li></ul> <p><a href="https://bitcoin.org/en/full-node#minimum-requirements" target="_blank" rel="noopener noreferrer">Bitcoin full node minimum requirements<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>[4GB Standard/32GB Standard]</p> <h2 id="_2-setup-server"><a href="#_2-setup-server" aria-hidden="true" class="header-anchor">#</a> 2. Setup Server</h2> <p><a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04" target="_blank" rel="noopener noreferrer">Initial server setup with Ubuntu 18.04<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="ssh-in-as-root"><a href="#ssh-in-as-root" aria-hidden="true" class="header-anchor">#</a> SSH in as Root</h3> <p>Putty (Note copypaste with Ctrl+Insert and Shift+Insert.)
<a href="https://www.digitalocean.com/community/tutorials/how-to-use-ssh-keys-with-putty-on-digitalocean-droplets-windows-users" target="_blank" rel="noopener noreferrer">How o use ssh keys with putty on Digital Ocean droplets Windowsusers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="create-a-new-user-and-grant-administrative-privileges"><a href="#create-a-new-user-and-grant-administrative-privileges" aria-hidden="true" class="header-anchor">#</a> Create a New User and Grant Administrative Privileges</h4> <div class="language-sh extra-class"><pre class="language-sh"><code>adduser user
<span class="token function">usermod</span> -aG <span class="token function">sudo</span> user
</code></pre></div><h2 id="setup-firewall"><a href="#setup-firewall" aria-hidden="true" class="header-anchor">#</a> Setup Firewall</h2> <p><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-14-04" target="_blank" rel="noopener noreferrer">How to set up a firewall with UFW on Ubunt 14.04<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-sh extra-class"><pre class="language-sh"><code>ufw allow OpenSSH
ufw <span class="token builtin class-name">enable</span>
</code></pre></div><blockquote><p>As the firewall is currently blocking all connections except for SSH, if you install and configure additional services, you will need to adjust the firewall settings to allow acceptable traffic in.
You can learn some common UFW operations in this guide.  ~ <a href="https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands" target="_blank" rel="noopener noreferrer">UFW essentials common firewal rules and commands<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h3 id="enable-external-access-for-user"><a href="#enable-external-access-for-user" aria-hidden="true" class="header-anchor">#</a> Enable External Access for User</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">rsync</span> --archive --chown<span class="token operator">=</span>user:user ~/.ssh /home/user
</code></pre></div><h3 id="update-ubuntu"><a href="#update-ubuntu" aria-hidden="true" class="header-anchor">#</a> Update Ubuntu</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt-get</span> dist-upgrade -y
</code></pre></div><h2 id="_3-install-net-sdk"><a href="#_3-install-net-sdk" aria-hidden="true" class="header-anchor">#</a> 3. Install .NET SDK</h2> <p><a href="https://www.microsoft.com/net/learn/get-started/linux/ubuntu18-04" target="_blank" rel="noopener noreferrer">.Net get started with Ubuntu 18.04<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Opt out of the telemetry: <code>export DOTNET_CLI_TELEMETRY_OPTOUT=1</code>.</p> <h2 id="_4-install-tor"><a href="#_4-install-tor" aria-hidden="true" class="header-anchor">#</a> 4. Install Tor</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> tor
</code></pre></div><p>Check if Tor is already running in the background:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>pgrep -ilfa tor
<span class="token function">sudo</span> <span class="token function">killall</span> tor
</code></pre></div><p>Verify Tor is properly running:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>tor
</code></pre></div><p>Create torrc:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> pico /etc/tor/torrc
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code>HiddenServiceDir /home/user/.hidden_service_v3
HiddenServiceVersion <span class="token number">3</span>
HiddenServicePort <span class="token number">80</span> <span class="token number">127.0</span>.0.1:37127

RunAsDaemon <span class="token number">1</span>

<span class="token comment"># ---MAKE TOR FASTER---</span>

<span class="token comment"># Need to disable for HiddenServiceNonAnonymousMode</span>
SOCKSPort <span class="token number">0</span>
<span class="token comment"># Need to enable for HiddenServiceSingleHopMode</span>
HiddenServiceNonAnonymousMode <span class="token number">1</span>
<span class="token comment"># This option makes every hidden service instance hosted by a tor</span>
<span class="token comment"># instance a Single Onion Service. One-hop circuits make Single Onion</span>
<span class="token comment"># servers easily locatable, but clients remain location-anonymous.</span>
HiddenServiceSingleHopMode <span class="token number">1</span>
</code></pre></div><p>Enable firewall:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> ufw allow <span class="token number">80</span>
</code></pre></div><p><strong>Backup the generated private key!</strong></p> <h2 id="_5-install-configure-and-synchronize-bitcoind"><a href="#_5-install-configure-and-synchronize-bitcoind" aria-hidden="true" class="header-anchor">#</a> 5. Install, Configure and Synchronize bitcoind</h2> <p><a href="https://bitcoin.org/en/download" target="_blank" rel="noopener noreferrer">Download bitcoind<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> add-apt-repository ppa:bitcoin/bitcoin
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> bitcoind
<span class="token function">mkdir</span> ~/.bitcoin
pico ~/.bitcoin/bitcoin.conf
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token assign-left variable">testnet</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span>/1<span class="token punctuation">]</span>

<span class="token punctuation">[</span>main/test<span class="token punctuation">]</span>.rpcworkqueue<span class="token operator">=</span><span class="token number">64</span>

<span class="token punctuation">[</span>main/test<span class="token punctuation">]</span>.txindex<span class="token operator">=</span><span class="token number">1</span>

<span class="token punctuation">[</span>main/test<span class="token punctuation">]</span>.daemon<span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">[</span>main/test<span class="token punctuation">]</span>.server<span class="token operator">=</span><span class="token number">1</span>
<span class="token punctuation">[</span>main/test<span class="token punctuation">]</span>.rpcuser<span class="token operator">=</span>bitcoinuser
<span class="token punctuation">[</span>main/test<span class="token punctuation">]</span>.rpcpassword<span class="token operator">=</span>password
<span class="token punctuation">[</span>main/test<span class="token punctuation">]</span>.whitebind<span class="token operator">=</span><span class="token number">127.0</span>.0.1:<span class="token punctuation">[</span><span class="token number">8333</span>/18333<span class="token punctuation">]</span>
</code></pre></div><p><a href="https://bitcoincore.org/en/releases/0.17.0/" target="_blank" rel="noopener noreferrer">Bitcoin Core v0.17.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://medium.com/@loopring/how-to-run-lighting-btc-node-and-start-mining-b55c4bab8ad" target="_blank" rel="noopener noreferrer">How to run Lightninb BTC node and start mining<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/MrChrisJ/fullnode/issues/18" target="_blank" rel="noopener noreferrer">Adding a Firewall<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> ufw allow <span class="token function">ssh</span>
<span class="token function">sudo</span> ufw allow <span class="token punctuation">[</span><span class="token number">18333</span>/8333<span class="token punctuation">]</span>
bitcoind
bitcoin-cli getblockcount
bitcoin-cli stop
bitcoind
</code></pre></div><h2 id="_6-publish-configure-and-run-walletwasabi-backend"><a href="#_6-publish-configure-and-run-walletwasabi-backend" aria-hidden="true" class="header-anchor">#</a> 6. Publish, Configure and Run WalletWasabi.Backend</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">git</span> clone https://github.com/zkSNACKs/WalletWasabi.git
<span class="token builtin class-name">cd</span> WalletWasabi
dotnet restore
dotnet build
dotnet publish WalletWasabi.Backend --configuration Release --self-contained <span class="token boolean">false</span>
dotnet WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish/WalletWasabi.Backend.dll
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
<span class="token function">cat</span> .walletwasabi/backend/Logs.txt
pico .walletwasabi/backend/Config.json
pico .walletwasabi/backend/CcjRoundConfig.json
dotnet WalletWasabi/WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish/WalletWasabi.Backend.dll
<span class="token function">cat</span> .walletwasabi/backend/Logs.txt
</code></pre></div><h2 id="_7-monitor-the-apps"><a href="#_7-monitor-the-apps" aria-hidden="true" class="header-anchor">#</a> 7. Monitor the Apps</h2> <h3 id="walletwasabi-backend"><a href="#walletwasabi-backend" aria-hidden="true" class="header-anchor">#</a> WalletWasabi.Backend</h3> <p><a href="https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/linux-nginx?view=aspnetcore-2.0&amp;tabs=aspnetcore2x" target="_blank" rel="noopener noreferrer">Aspnet host and deploy Linux nginx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> pico /etc/systemd/system/walletwasabi.service
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>WalletWasabi Backend API

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/home/user/WalletWasabi/WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/dotnet /home/user/WalletWasabi/WalletWasabi.Backend/bin/Release/netcoreapp2.2/publish/WalletWasabi.Backend.dll
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>always
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span><span class="token number">10</span>  <span class="token comment"># Restart service after 10 seconds if dotnet service crashes</span>
<span class="token assign-left variable">SyslogIdentifier</span><span class="token operator">=</span>walletwasabi-backend
<span class="token assign-left variable">User</span><span class="token operator">=</span>user
<span class="token assign-left variable">Environment</span><span class="token operator">=</span>DOTNET_PRINT_TELEMETRY_MESSAGE<span class="token operator">=</span>false

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> walletwasabi.service
<span class="token function">sudo</span> systemctl start walletwasabi.service
systemctl status walletwasabi.service
<span class="token function">tail</span> -10000 .walletwasabi/backend/Logs.txt
</code></pre></div><h3 id="tor"><a href="#tor" aria-hidden="true" class="header-anchor">#</a> Tor</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>tor
pgrep -ilfa tor
</code></pre></div><h2 id="_8-setup-nginx"><a href="#_8-setup-nginx" aria-hidden="true" class="header-anchor">#</a> 8. Setup nginx</h2> <p><a href="https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/linux-nginx?view=aspnetcore-2.0&amp;tabs=aspnetcore2x#install-nginx" target="_blank" rel="noopener noreferrer">Aspnet install nginx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Only setup nginx if you want to expose the autogenerated website to the clearnet.</p> <p>Enable firewall:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> ufw allow http
<span class="token function">sudo</span> ufw allow https
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> nginx -y
<span class="token function">sudo</span> <span class="token function">service</span> nginx start
</code></pre></div><p>Verify the browser displays the default landing page for Nginx.
The landing page is reachable at <code>http://&lt;server_IP_address&gt;/index.nginx-debian.html</code>.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> pico /etc/nginx/sites-available/default
</code></pre></div><p>Fill out the server name with the server's IP and domain.
And remove the unneeded domains (note I use <code>wasabiwallet.co</code> for testnet.)</p> <div class="language- extra-class"><pre class="language-text"><code>server {
    listen        80;
    listen        [::]:80;
    listen        443 ssl;
    listen        [::]:443 ssl;
    server_name   [InsertServerIPHere] wasabiwallet.io www.wasabiwallet.io wasabiwallet.net www.wasabiwallet.net wasabiwallet.org www.wasabiwallet.org wasabiwallet.info www.wasabiwallet.info wasabiwallet.co www.wasabiwallet.co zerolink.info www.zerolink.info hiddenwallet.org www.hiddenwallet.org;
    location / {
        proxy_pass         http://localhost:37127;
    }
}
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> nginx -t
<span class="token function">sudo</span> nginx -s reload
</code></pre></div><p>Setup https, redirect to https when asks.
This will modify the above config file, but oh well.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> certbot -d wasabiwallet.io -d www.wasabiwallet.io -d wasabiwallet.net -d www.wasabiwallet.net -d wasabiwallet.org -d www.wasabiwallet.org -d wasabiwallet.info -d www.wasabiwallet.info -d wasabiwallet.co -d www.wasabiwallet.co -d zerolink.info -d www.zerolink.info -d hiddenwallet.org -d www.hiddenwallet.org
</code></pre></div><p>certbot will not properly redirect www, so it must be setup by hand, one by one.
Duplicate all entries like this by adding a <code>www.</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>server {
    if ($host = wasabiwallet.co) {
        return 301 https://$host$request_uri;
    }
}
</code></pre></div><p>Add <code>add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains; preload&quot; always;</code> and <code>server_tokens off;</code> to every HTTPS <code>server</code> block.</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> nginx -t
<span class="token function">sudo</span> nginx -s reload
</code></pre></div><p>After accessing the website finalize preload in https://hstspreload.org/</p> <h2 id="check-if-everything-works"><a href="#check-if-everything-works" aria-hidden="true" class="header-anchor">#</a> Check If Everything Works</h2> <p>TestNet: http://testwnp3fugjln6vh5vpj7mvq3lkqqwjj3c2aafyu7laxz42kgwh2rad.onion/swagger/
Main: http://wasabiukrxmkdgve5kynjztuovbg43uxcbcxn6y2okcrsg7gb6jdmbad.onion/swagger/
GET fees</p> <p>http://www.wasabiwallet.io/</p> <h2 id="check-statuses"><a href="#check-statuses" aria-hidden="true" class="header-anchor">#</a> Check Statuses</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">tail</span> -f ~/.bitcoin/debug.log
<span class="token function">tail</span> -10000 .walletwasabi/backend/Logs.txt
<span class="token function">du</span> -bsh .walletwasabi/backend/IndexBuilderService/*
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zkSNACKs/WasabiDoc/edit/master/docs/using-wasabi/BackendDeployment.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/3/2019, 11:30:36 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/using-wasabi/ClientDeployment.html" class="prev">
          Client Deployment
        </a></span> <span class="next"><a href="/using-wasabi/AddressReuse.html">
          Address Reuse
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.9b39d3c4.js" defer></script><script src="/assets/js/2.5eea116b.js" defer></script><script src="/assets/js/29.5a32ac8a.js" defer></script>
  </body>
</html>
